<!doctype html><html lang=vi-vn>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> Microservices vá»›i NodeJS pháº§n 3 - Running Services With Docker | Thá»‰nh thoáº£ng Ä‘Ã´i lá»i</title>
<link rel=canonical href=/posts/backend/microservices-with-node-p3/>
<meta name=description content="LÃ  nÆ¡i chia sáº» láº¡i nhá»¯ng kiáº¿n thá»©c, kinh nghiá»‡m mÃ¬nh tiáº¿p thu Ä‘Æ°á»£c trong quÃ¡ trÃ¬nh há»c táº­p vÃ  lÃ m viá»‡c. VÃ  thá»‰nh thoáº£ng cÅ©ng Ä‘Äƒng má»™t vÃ i demo ngá»› ngáº©n ná»¯a :smile:">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="Microservices vá»›i NodeJS pháº§n 3 - Running Services With Docker">
<meta property="og:description" content="Váº­y lÃ  mini app cá»§a chÃºng ta Ä‘Ã£ hoÃ n táº¥t, bÃ¢y giá» chÃºng ta báº¯t Ä‘áº§u nghÄ© Ä‘áº¿n viá»‡c deploy nÃ³ online Ä‘á»ƒ ngÆ°á»i khÃ¡c cÃ³ thá»ƒ truy cáº­p vÃ o.
TrÆ°á»›c tÃªn hay xem láº¡i app cá»§a chÃºng ta Ä‘ang Ä‘Æ°á»£c thá»±c thi nhÆ° tháº¿ nÃ o trÃªn local. Hiá»‡n táº¡i thÃ¬ má»—i service Ä‘á»u cháº¡y trÃªn 1 port cá»¥ thá»ƒ vÃ  cÃ³ thá»ƒ giao tiáº¿p vá»›i nhau qua axios. Váº­y lÃ m sao ta cÃ³ thá»ƒ thay Ä‘á»•i 1 chÃºt vÃ  deploy toÃ n bá»™ app nÃ y?">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/backend/microservices-with-node-p3/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-09-11T00:00:00+00:00">
<meta property="article:modified_time" content="2021-09-11T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Microservices vá»›i NodeJS pháº§n 3 - Running Services With Docker">
<meta name=twitter:description content="Váº­y lÃ  mini app cá»§a chÃºng ta Ä‘Ã£ hoÃ n táº¥t, bÃ¢y giá» chÃºng ta báº¯t Ä‘áº§u nghÄ© Ä‘áº¿n viá»‡c deploy nÃ³ online Ä‘á»ƒ ngÆ°á»i khÃ¡c cÃ³ thá»ƒ truy cáº­p vÃ o.
TrÆ°á»›c tÃªn hay xem láº¡i app cá»§a chÃºng ta Ä‘ang Ä‘Æ°á»£c thá»±c thi nhÆ° tháº¿ nÃ o trÃªn local. Hiá»‡n táº¡i thÃ¬ má»—i service Ä‘á»u cháº¡y trÃªn 1 port cá»¥ thá»ƒ vÃ  cÃ³ thá»ƒ giao tiáº¿p vá»›i nhau qua axios. Váº­y lÃ m sao ta cÃ³ thá»ƒ thay Ä‘á»•i 1 chÃºt vÃ  deploy toÃ n bá»™ app nÃ y?">
<link rel=stylesheet href=/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writings</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/tags>Tags</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=/posts/backend/microservices-with-node-p2/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=/posts/backend/microservices-with-node-p4/ aria-label=Next>
<i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&text=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&title=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&is_video=false&description=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker&body=Check out this article: %2fposts%2fbackend%2fmicroservices-with-node-p3%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&title=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&title=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&name=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker&description=V%e1%ba%ady%20l%c3%a0%20mini%20app%20c%e1%bb%a7a%20ch%c3%bang%20ta%20%c4%91%c3%a3%20ho%c3%a0n%20t%e1%ba%a5t%2c%20b%c3%a2y%20gi%e1%bb%9d%20ch%c3%bang%20ta%20b%e1%ba%aft%20%c4%91%e1%ba%a7u%20ngh%c4%a9%20%c4%91%e1%ba%bfn%20vi%e1%bb%87c%20deploy%20n%c3%b3%20online%20%c4%91%e1%bb%83%20ng%c6%b0%e1%bb%9di%20kh%c3%a1c%20c%c3%b3%20th%e1%bb%83%20truy%20c%e1%ba%adp%20v%c3%a0o.%0aTr%c6%b0%e1%bb%9bc%20t%c3%aan%20hay%20xem%20l%e1%ba%a1i%20app%20c%e1%bb%a7a%20ch%c3%bang%20ta%20%c4%91ang%20%c4%91%c6%b0%e1%bb%a3c%20th%e1%bb%b1c%20thi%20nh%c6%b0%20th%e1%ba%bf%20n%c3%a0o%20tr%c3%aan%20local.%20Hi%e1%bb%87n%20t%e1%ba%a1i%20th%c3%ac%20m%e1%bb%97i%20service%20%c4%91%e1%bb%81u%20ch%e1%ba%a1y%20tr%c3%aan%201%20port%20c%e1%bb%a5%20th%e1%bb%83%20v%c3%a0%20c%c3%b3%20th%e1%bb%83%20giao%20ti%e1%ba%bfp%20v%e1%bb%9bi%20nhau%20qua%20axios.%20V%e1%ba%ady%20l%c3%a0m%20sao%20ta%20c%c3%b3%20th%e1%bb%83%20thay%20%c4%91%e1%bb%95i%201%20ch%c3%bat%20v%c3%a0%20deploy%20to%c3%a0n%20b%e1%bb%99%20app%20n%c3%a0y%3f" aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&t=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#deployment-issues>Deployment Issues</a>
<ul>
<li><a href=#issues>Issues</a></li>
<li><a href=#conclusion>Conclusion</a></li>
</ul>
</li>
<li><a href=#why-docker->Why Docker ?</a></li>
<li><a href=#dockerizing-posts-service>Dockerizing Posts Service</a></li>
<li><a href=#review-some-basic-commands>Review Some Basic Commands</a></li>
</ul>
</nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
Microservices vá»›i NodeJS pháº§n 3 - Running Services With Docker
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2021-09-11 00:00:00 +0000 UTC" itemprop=datePublished>2021-09-11</time>
</div>
<div class=article-category>
<i class="fas fa-archive"></i>
<a class=category-link href=/categories/backend>backend</a>
,
<a class=category-link href=/categories/devops>devops</a>
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/microservices rel=tag>microservices</a>
,
<a class=tag-link href=/tags/nodejs rel=tag>nodejs</a>
,
<a class=tag-link href=/tags/monoliths rel=tag>monoliths</a>
,
<a class=tag-link href=/tags/architecture rel=tag>architecture</a>
,
<a class=tag-link href=/tags/backend rel=tag>backend</a>
,
<a class=tag-link href=/tags/devops rel=tag>devops</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<p>Váº­y lÃ  mini app cá»§a chÃºng ta Ä‘Ã£ hoÃ n táº¥t, bÃ¢y giá» chÃºng ta báº¯t Ä‘áº§u nghÄ© Ä‘áº¿n viá»‡c deploy nÃ³ online Ä‘á»ƒ ngÆ°á»i khÃ¡c cÃ³ thá»ƒ truy cáº­p vÃ o.</p>
<p>TrÆ°á»›c tÃªn hay xem láº¡i app cá»§a chÃºng ta Ä‘ang Ä‘Æ°á»£c thá»±c thi nhÆ° tháº¿ nÃ o trÃªn local.
<img src=/images/microservices-dg-57.png alt=microservices-dg-57></p>
<p>Hiá»‡n táº¡i thÃ¬ má»—i service Ä‘á»u cháº¡y trÃªn 1 port cá»¥ thá»ƒ vÃ  cÃ³ thá»ƒ giao tiáº¿p vá»›i nhau qua axios. Váº­y lÃ m sao ta cÃ³ thá»ƒ thay Ä‘á»•i 1 chÃºt vÃ  deploy toÃ n bá»™ app nÃ y? CÃ¡ch dá»… nháº¥t lÃ  lÃªn aws thuÃª 1 instance EC2 sau Ä‘Ã³ clone toÃ n bá»™ project vá» cháº¡y tá»«ng service má»™t nhÆ° cháº¡y trÃªn local. CÃ¡ch nÃ y thÃ¬ hoÃ n toÃ n giÃºp chÃºng ta deploy vÃ  user cÃ³ thá»ƒ truy cáº­p Ä‘Æ°á»£c nhÆ°ng hÃ£y thá»­ nghÄ© xem náº¿u app cÃ³ nhiá»u lÆ°á»£ng truy cáº­p thÃ¬ sáº½ nhÆ° tháº¿ nao ?</p>
<h2 id=deployment-issues>Deployment Issues</h2>
<p>Láº¥y vÃ­ dá»¥ cháº³ng háº¡n sáº½ cÃ³ 1 lÆ°á»£ng lá»›n user táº¡o comment, lÃºc nÃ y chÃºng ta cáº§n pháº£i táº¡o thÃªm instance cho comments Ä‘á»ƒ cÃ³ thá»ƒ handle lÆ°á»£ng requests vÃ  cÃ¡ch Ä‘Æ¡n giáº£n nháº¥t lÃ  táº¡o thÃªm 2 comment service ná»¯a cháº³ng háº¡n á»Ÿ port 4006 vÃ  4007. Váº­y ta cÃ³ 3 comment service á»Ÿ port 4001, 4006 vÃ  4007, lÃºc user táº¡o comment má»›i ta sáº½ cÃ¢n báº±ng táº£i 3 service nÃ y (cÃ¢n báº±ng lÆ°á»£ng request Ä‘áº¿n 3 service, Ä‘iá»u chá»‰nh xem request má»›i nÃªn gá»­i tá»›i service nÃ o cho cÃ¢n báº±ng).</p>
<h3 id=issues>Issues</h3>
<p>CÃ³ má»™t vÃ i thÃ¡ch thá»©c vá»›i cÃ¡ch tiáº¿p cáº­n trÃªn:
<img src=/images/microservices-dg-58.png alt=microservices-dg-58></p>
<ul>
<li>
<p>Má»—i service má»›i sáº½ Ä‘Æ°á»£c gáº¯n 1 port má»›i. VÃ  nhá»› lÃ  eventbus cáº§n biáº¿t Ä‘Æ°á»£c chÃ­nh xÃ¡c port cá»§a service Ä‘á»ƒ gá»­i event, nÃªn náº¿u chÃºng ta muá»‘n update port hoáº·c tÄƒng giáº£m sá»‘ lÆ°á»£ng instance cá»§a service thÃ¬ pháº£i thay Ä‘á»•i trá»±c tiáº¿p vÃ o code vÃ  deploy láº¡i.
<img src=/images/microservices-dg-59.png alt=microservices-dg-59></p>
</li>
<li>
<p>TrÆ°á»ng há»£p xáº¥u hÆ¡n khi sá»‘ lÆ°á»£ng service tÄƒng nhiá»u vÃ  mÃ¡y áº£o báº¡n thuÃª khÃ´ng cÃ²n Ä‘á»§ Ä‘Ã¡p á»©ng ná»¯a, báº¡n sáº½ pháº£i thuÃª thÃªm 1 mÃ¡y áº£o vÃ  phÃ¢n bá»‘ bá»›t lÆ°á»£ng service sang mÃ¡y áº£o má»›i. LÃºc nÃ y EventBus khÃ´ng chá»‰ pháº£i theo dÃµi port cá»§a service má»›i mÃ  cÃ²n pháº£i biáº¿t cÃ¡ch giao tiáº¿p vá»›i mÃ¡y áº£o thá»© 2, tá»©c lÃ  báº¡n pháº£i update Ä‘á»‹a chá»‰ ip cá»§a mÃ¡y áº£o thá»© 2 Ä‘Ã³ trong code vÃ  viá»‡c nÃ y ráº¥t lÃ  phiá»n phá»©c.</p>
</li>
<li>
<p>Má»™t trÆ°á»ng há»£p ná»¯a lÃ  cháº³ng háº¡n vÃ o ban ngÃ y lÆ°á»£ng user vÃ o app cá»§a báº¡n cá»±c ká»³ nhiá»u vÃ  báº¡n thuÃª thÃªm mÃ¡y áº£o, nhÆ°ng lÃºc vá» Ä‘Ãªm thÃ¬ user giáº£m sÃ¢u, lÃºc nÃ y báº¡n muá»‘n tiáº¿p kiá»‡m chi phÃ­ nÃªn táº¡m thá»i ngá»«ng thuÃª mÃ¡y áº£o má»›i, báº¡n sáº½ pháº£i thÃªm Ä‘iá»u kiá»‡n check thá»i gian cho pháº§n code gá»­i request Ä‘áº¿n mÃ¡y áº£o má»›i.</p>
</li>
</ul>
<h3 id=conclusion>Conclusion</h3>
<ul>
<li>Káº¿t luáº­n lÃ  cÃ¡ch tiáº¿p cáº­n trÃªn chÆ°a biáº¿t cÃ³ sá»­ dá»¥ng tá»‘t hay khÃ´ng nhÆ°ng thá»±c sá»± lÃ  quÃ¡ phá»©c táº¡p vÃ  ráº¯c rá»‘i, chÃºng ta cáº§n giáº£i phÃ¡p thay tháº¿ tá»‘t hÆ¡n.</li>
<li>ChÃºng ta cáº§n má»™t giáº£i phÃ¡p cÃ³ thá»ƒ theo dÃµi toÃ n bá»™ cÃ¡c services cháº¡y trong app, cÃ³ kháº£ nÄƒng táº¡o copies cá»§a 1 service lÃºc cáº§n thiáº¿t,&mldr; vÃ  docker, kubernetes cÃ³ thá»ƒ giÃºp báº¡n Ä‘iá»u nÃ y.</li>
</ul>
<h2 id=why-docker->Why Docker ?</h2>
<p>ğŸ“” Báº¡n Ä‘á»c cÃ³ thá»ƒ tham kháº£o thÃªm <a href=/posts/backend/docker-fundamentals/>á»Ÿ Ä‘Ã¢y</a>
<img src=/images/microservices-dg-60.png alt=microservices-dg-60>
Sá»­ dá»¥ng docker ta sáº½ Ä‘Ã³ng gÃ³i cÃ¡c services láº¡i thÃ nh cÃ¡c containers.</p>
<p><strong>Táº¡i sao láº¡i sá»­ dá»¥ng docker ?</strong></p>
<ul>
<li>Hiá»‡n táº¡i cÃ¡ch cháº¡y app cá»§a chÃºng ta thÃ¬ ta Ä‘ang giáº£ Ä‘á»‹nh lÃ  mÃ´i trÆ°á»ng cháº¡y app sáº½ giá»‘ng vá»›i mÃ´i trÆ°á»ng local. Cháº³ng háº¡n vá»›i <code>yarn start</code> thÃ¬ ta Ä‘ang giáº£ Ä‘á»‹nh lÃ  mÃ´i trÆ°á»ng production cá»§a app cÅ©ng Ä‘Ã£ cÃ i Ä‘áº·t yarn vÃ  nodejs.</li>
<li>Thá»© 2 lÃ  chÃºng ta cÅ©ng cáº§n biáº¿t cÃ¢u lá»‡nh chÃ­nh xÃ¡c Ä‘á»ƒ cÃ³ thá»ƒ cháº¡y app cá»§a mÃ¬nh (yarn start)</li>
<li>Docker giáº£i quyáº¿t cáº£ 2 váº¥n Ä‘á» trÃªn, nÃ³ Ä‘Ã³ng gÃ³i toÃ n bá»™ package cÃ¹ng code mÃ  app cáº§n Ä‘á»ƒ cháº¡y, nÃ³ cÅ©ng cung cáº¥p cho ta config cÃ¡ch run á»©ng dá»¥ng.</li>
</ul>
<p><strong>Táº¡i sao láº¡i sá»­ dá»¥ng kubernetes ?</strong>
Äáº§u tiÃªn kubernetes lÃ  gÃ¬ ?
<img src=/images/microservices-dg-61.png alt=microservices-dg-61></p>
<ul>
<li>NÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n, kubernetes lÃ  má»™t cÃ´ng cá»¥ Ä‘á»ƒ cháº¡y cÃ¡c containers má»™t cÃ¡ch Ä‘Æ¡n giáº£n vÃ  dá»… hiá»ƒu.</li>
<li>Ta cung cáº¥p cho nÃ³ 1 config file miÃªu táº£ cÃ¡ch ta muá»‘n containers cháº¡y vÃ  tÆ°Æ¡ng tÃ¡c vá»›i nhau.</li>
</ul>
<p><img src=/images/microservices-dg-62.png alt=microservices-dg-62>
Sá»­ dá»¥ng Kubernetes ta sáº½ táº¡o 1 Kubernetes Cluster - má»™t bá»™ cÃ¡c mÃ¡y áº£o khÃ¡c nhau, cÃ³ thá»ƒ lÃ  má»™t hoáº·c hÃ ng trÄƒm ngÃ n mÃ¡y. Má»—i mÃ¡y thÃ¬ Ä‘Æ°á»£c xem lÃ  1 <code>Node</code> vÃ  Ä‘Æ°á»£c quáº£n lÃ½ bá»Ÿi Master - lÃ  chÆ°Æ¡ng trÃ¬nh sáº½ quáº£n lÃ½ táº¥t cáº£ má»i thá»© trong cluster.</p>
<p>Ta sáº½ sá»­ dá»¥ng Kubernetes Ä‘á»ƒ cháº¡y á»©ng dá»¥ng, á»©ng dá»¥ng cá»§a chÃºng ta Ä‘Æ°á»£c Ä‘Ã³ng gÃ³i thÃ nh container sau Ä‘Ã³ thÃ¬ Ä‘Æ°á»£c cÃ¢n báº±ng táº£i assign vÃ o 1 trong cÃ¡c node. Cá»¥ thá»ƒ nhÆ° sau:</p>
<p><img src=/images/microservices-dg-63.png alt=microservices-dg-63>
Ta sáº½ táº¡o ra má»™t sá»‘ config files cung cáº¥p nhá»¯ng chi tiáº¿t cá»¥ thá»ƒ mÃ  ta muá»‘n Kubernetes thá»±c hiá»‡n. Cháº³ng háº¡n nhÆ° cháº¡y 2 copies cá»§a PostService vÃ  cho phÃ©p truy cáº­p vÃ o 2 copies Ä‘áº¥y. Master sáº½ Ä‘á»c config files vÃ  implement táº¥t cáº£ cÃ¡c bÆ°á»›c mÃ  ta viáº¿t trong Ä‘áº¥y.</p>
<p>Issue vá» váº¥n Ä‘á» giao tiáº¿p giá»¯a cÃ¡c service khi má»—i service cÃ³ nhiá»u copies cÅ©ng Ä‘Æ°á»£c giáº£i quyáº¿t bá»Ÿi Kubernetes, lÃºc nÃ y Event Bus chá»‰ viá»‡c gá»­i request Ä‘áº¿n kÃªnh giao tiáº¿p chung vÃ  chÃºng sáº½ Ä‘Æ°á»£c forwarded Ä‘áº¿n service cáº§n thiáº¿t.</p>
<h2 id=dockerizing-posts-service>Dockerizing Posts Service</h2>
<p><img src=/images/microservices-dg-64.png alt=microservices-dg-64></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Dockerfile data-lang=Dockerfile><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> node:alpine</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /app</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> package.json ./<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> npm install<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> . .<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>CMD</span> [<span style=color:#e6db74>&#34;npm&#34;</span>, <span style=color:#e6db74>&#34;start&#34;</span>]<span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p>Build image</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>docker build -t ducnguyen96/mini-microservice-postservice:0.0.1 .
</code></pre></div><p>Run container</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>docker run -it --name mini-microservice-postservice -p 4000:4000 ducnguyen96/mini-microservice-postservice:0.0.1
</code></pre></div><h2 id=review-some-basic-commands>Review Some Basic Commands</h2>
<p><img src=/images/microservices-dg-65.png alt=microservices-dg-65></p>
</div>
</article>
<div class=blog-post-comments>
<div id=disqus_thread>
<script type=text/javascript>(function(){var a=document.createElement('script'),b;a.type='text/javascript',a.async=!0,b='ducnguyen96',a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</div>
</div>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writings</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/tags>Tags</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents>
<ul>
<li><a href=#deployment-issues>Deployment Issues</a>
<ul>
<li><a href=#issues>Issues</a></li>
<li><a href=#conclusion>Conclusion</a></li>
</ul>
</li>
<li><a href=#why-docker->Why Docker ?</a></li>
<li><a href=#dockerizing-posts-service>Dockerizing Posts Service</a></li>
<li><a href=#review-some-basic-commands>Review Some Basic Commands</a></li>
</ul>
</nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&text=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&title=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&is_video=false&description=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker&body=Check out this article: %2fposts%2fbackend%2fmicroservices-with-node-p3%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&title=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&title=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&name=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker&description=V%e1%ba%ady%20l%c3%a0%20mini%20app%20c%e1%bb%a7a%20ch%c3%bang%20ta%20%c4%91%c3%a3%20ho%c3%a0n%20t%e1%ba%a5t%2c%20b%c3%a2y%20gi%e1%bb%9d%20ch%c3%bang%20ta%20b%e1%ba%aft%20%c4%91%e1%ba%a7u%20ngh%c4%a9%20%c4%91%e1%ba%bfn%20vi%e1%bb%87c%20deploy%20n%c3%b3%20online%20%c4%91%e1%bb%83%20ng%c6%b0%e1%bb%9di%20kh%c3%a1c%20c%c3%b3%20th%e1%bb%83%20truy%20c%e1%ba%adp%20v%c3%a0o.%0aTr%c6%b0%e1%bb%9bc%20t%c3%aan%20hay%20xem%20l%e1%ba%a1i%20app%20c%e1%bb%a7a%20ch%c3%bang%20ta%20%c4%91ang%20%c4%91%c6%b0%e1%bb%a3c%20th%e1%bb%b1c%20thi%20nh%c6%b0%20th%e1%ba%bf%20n%c3%a0o%20tr%c3%aan%20local.%20Hi%e1%bb%87n%20t%e1%ba%a1i%20th%c3%ac%20m%e1%bb%97i%20service%20%c4%91%e1%bb%81u%20ch%e1%ba%a1y%20tr%c3%aan%201%20port%20c%e1%bb%a5%20th%e1%bb%83%20v%c3%a0%20c%c3%b3%20th%e1%bb%83%20giao%20ti%e1%ba%bfp%20v%e1%bb%9bi%20nhau%20qua%20axios.%20V%e1%ba%ady%20l%c3%a0m%20sao%20ta%20c%c3%b3%20th%e1%bb%83%20thay%20%c4%91%e1%bb%95i%201%20ch%c3%bat%20v%c3%a0%20deploy%20to%c3%a0n%20b%e1%bb%99%20app%20n%c3%a0y%3f" aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=%2fposts%2fbackend%2fmicroservices-with-node-p3%2f&t=Microservices%20v%e1%bb%9bi%20NodeJS%20ph%e1%ba%a7n%203%20-%20Running%20Services%20With%20Docker" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021 ducnguyen96
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writings</a></li>
<li><a href=/categories>Categories</a></li>
<li><a href=/tags>Tags</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>